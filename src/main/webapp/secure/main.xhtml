<?xml version = "1.0" encoding = "UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui">

<h:head>
	<title>Добро пожаловать, #{user.name}!</title>
	<link href="css/default.css" rel="stylesheet" type="text/css" />
	<link href="css/clientform.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript">
		function openSearchResult() {
			searchByNameDlg.hide();
			searchByIdDlg.hide();
			displayFoundByName.show()
		}
		
		function reload() {
			location.reload();
		}
	</script>

</h:head>
<h:body>
	<ui:include src="clientform/mainmenu.xhtml" />
<p:panel id="base_panel" widgetVar="base_panelWv" style="#{clientform.mainPanelVisibility}">
	<p:tabView effect="fade" effectDuration="normal" id="m_tabview">
		<p:ajax event="tabChange" listener="#{clientform.tabChangeListener}" update="base_form documents_form"/>  
		<p:tab title="Базовая информация">
			<!-- *** Basic Client Form *** -->
			<h:form id="base_form">
				<p:panel id="base_cliet_edit_panel">
					<div id="client_main_panel">
						<div id="client_edit_window">
							<p:fieldset>
								<div id="base_form_div">
									<ui:include src="clientform/maininfo.xhtml" />
								</div>
								<div id="services_div">
									<p:fieldset legend="Оказанные услуги">
										<ui:include src="clientform/providedservices.xhtml" />
									</p:fieldset>
								</div>
								<div id="optional_info_div">
									<p:fieldset>
										<div id="personal_info_div">
											<p:fieldset legend="Персональная информация">
												<ui:include src="clientform/personalinfo.xhtml" />
											</p:fieldset>
										</div>
										<div id="homeless_reasons_div">
											<p:fieldset legend="Причины бездомности">
												<ui:include src="clientform/homelessreasons.xhtml" />
											</p:fieldset>
										</div>
										<div id="existence_sources_div">
											<p:fieldset legend="Источники существования">
												<ui:include src="clientform/breadwinner.xhtml" />
											</p:fieldset>
										</div>
										<div id="chronical_distasters_div">
											<p:fieldset legend="Хронические заболевания">
												<ui:include src="clientform/chronicaldisasters.xhtml" />
											</p:fieldset>
										</div>
									</p:fieldset>
								</div>

								<!-- optional info -->
							</p:fieldset>
							<p:growl id="growl" showDetail="true" life="3000" />
							<center>
								<p:commandButton value="Сохранить" actionListener="#{clientform.saveClientForm(clientform)}" id="saveClientForm" update="@this :m_tabview:base_form base_form_panel_grid growl" icon="ui-icon-check" />
							</center>
						</div>
						<!-- client edit window -->
					</div>
				</p:panel>

			</h:form>
			<!-- *** End Of Basic Client Form *** -->

		</p:tab>
		<p:tab title="Документы">
			<!-- *** Client Documents Form *** -->
			<h:form id="documents_form">
				<p:panel id="documents_main_panel">
					<div id="client_documents_panel_div">
					
					<p:contextMenu for="doclistId">
						<p:menuitem value="Удалить" update="doclistId" icon="ui-icon-close" actionListener="#{clientdocuments.deleteDocument()}" action="#{clientdocuments.reload()}" ajax="true" />
						<p:menuitem value="Редактировать" update="doclistId" icon="ui-icon-pencil" actionListener="#{clientdocuments.editDocument()}" action="#{clientdocuments.reload()}" ajax="true" />
					</p:contextMenu>
					
					
						<p:dataTable id="doclistId" var="doclist" value="#{clientdocuments.documentsList}" paginator="true" rows="15"
				paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="5,10,15"
				rowKey="#{doclist.id}" selection="#{clientdocuments.selectedDocument}" selectionMode="single">

				<p:column headerText="ID">
					<h:outputText value="#{doclist.id}" />
				</p:column>

				<p:column headerText="Тип">
					<h:outputText value="#{doclist.doctype}" />
				</p:column>
				<p:column headerText="Серия">
					<h:outputText value="#{doclist.docPrefix}" />
				</p:column>
				<p:column headerText="Номер">
					<h:outputText value="#{doclist.docNum}" />
				</p:column>
				<p:column headerText="Орган выдачи">
					<h:outputText value="#{doclist.whereAndWhom}" />
				</p:column>
				<p:column headerText="Дата выдачи">
					<h:outputText value="#{clientdocuments.formatDate(doclist.date)}" />
				</p:column>
				<p:column headerText="Регистрация">
					<h:outputText value="#{clientdocuments.getStringRegistrationConfirmation(doclist.registration)}" />
				</p:column>
				<p:column headerText="Регистрация: город">
					<h:outputText value="#{doclist.city}" />
				</p:column>
				<p:column headerText="Регистрация: адрес">
					<h:outputText value="#{doclist.address}" />
				</p:column>
				
			</p:dataTable>
			<center>
				<p:commandButton value="Добавить документ" onclick="addDocumentWv.show();" icon="ui-icon-circle-plus" type="button" />
			</center>
			
					
					</div>
				</p:panel>
			</h:form>
		</p:tab>
	</p:tabView>
</p:panel>
	<!-- Include Dialogs -->
	<ui:include src="dialogs/search.xhtml" />
	<ui:include src="dialogs/addservices.xhtml" />
	<ui:include src="dialogs/addclient.xhtml" />
	<ui:include src="dialogs/webcamera.xhtml" />
	<ui:include src="dialogs/adddocument.xhtml" />




</h:body>

</html>